modules = ["nodejs-20", "python-3.11"]

[nix]
channel = "stable-24_05"

[workflows]
runButton = "Static Server with No Cache"

[[workflows.workflow]]
name = "Project"
mode = "parallel"
author = "agent"

[[workflows.workflow.tasks]]
task = "workflow.run"
args = "Static Server"

[[workflows.workflow]]
name = "Static Server"
author = "agent"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "python3 -m http.server 5000"
waitForPort = 5000

[[workflows.workflow]]
name = "Static Server with No Cache"
author = 44614365
mode = "sequential"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "python3 -c \""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "import http.server"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "import socketserver"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "from http.server import SimpleHTTPRequestHandler"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = ""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "class NoCacheHTTPRequestHandler(SimpleHTTPRequestHandler):"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "    def end_headers(self):"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "        self.send_header('Cache-Control', 'no-cache, no-store, must-revalidate')"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "        self.send_header('Pragma', 'no-cache')"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "        self.send_header('Expires', '0')"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "        super().end_headers()"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = ""

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "with socketserver.TCPServer(('0.0.0.0', 5000), NoCacheHTTPRequestHandler) as httpd:"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "    print('Serving HTTP on 0.0.0.0 port 5000 (http://0.0.0.0:5000/) ...')"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "    httpd.serve_forever()"

[[workflows.workflow.tasks]]
task = "shell.exec"
args = "\""

[[ports]]
localPort = 5000
externalPort = 80
